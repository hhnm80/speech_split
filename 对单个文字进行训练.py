import librosafrom glob import globimport tensorflow as tffrom keras.layers import *from keras.models import Sequential,load_modelfrom keras.utils.np_utils import to_categoricalimport pandas as pdimport matplotlib.pyplot as pltimport numpy as npimport mfcc_1标准版 as mfcc_tf# path="H:\语音训练数据集(个人录制)"# 修改pathpath="语音训练数据集(个人录制)"wav_file = glob(path+"/*/*.wav")#print (wav_file)wav_file_len = len(wav_file)x_train = np.zeros((wav_file_len,32,40))# y_train = np.zeros((wav_file_len))y_train = np.arange(wav_file_len)# y_train=y_train.astype(str)# y_train = y_train.astype(np.str_) #转换成字符类型# 创建一个wav_file_len长度的列表,,,,,# y_train = ["" for i in range(wav_file_len)]for index,file in enumerate(wav_file):  file_feature = mfcc_tf.get_mfcc_simplify(file)  file_label = file.split("\\")[-2]  x_train[index] = file_feature  y_train[index] = file_label  print (file_feature.shape,file_label)# 获得x_train和y_train的信息# 对矩阵变形,变化成二维矩阵,-1的意思是我们不知道有多少行,但是我们知道每一行的元素个数是532*40,x_train是一个三维数组,第一维是文件夹下面所有的wav文件的个数,第二维是532,第三维是40x_train = x_train.reshape(-1, 32 * 40)# x_train = x_train.reshape(-1, 532,40)#向量的独热表示# y_train_hot = to_categorical(y_train)# print (x_train,y_train)# 建立神经网络.利用kerasmodel = Sequential()model.add(Dense(128, activation='relu', input_shape=(32 * 40,)))# model.add(Dense(128, activation='relu', input_shape=(532,40)))model.add(Dense(64, activation='relu'))model.add(Dense(64, activation='relu'))model.add(Dense(11, activation='softmax'))"""model= Sequential()model.add(Dense(128,activation='relu',input_shape=(532*40,)))model.add(Dropout(0.1))model.add(Dense(64,activation='relu'))model.add(Dropout(0.1))model.add(Dense(64,activation='relu'))model.add(Dropout(0.1))model.add(Dense(3, activation='softmax'))"""model.summary()model.compile(loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True),              optimizer=tf.keras.optimizers.RMSprop(),              metrics=['accuracy'])history = model.fit(x_train, y_train, batch_size=3, epochs=400)model.save("audio1.h5")